<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<migration xmlns="http://ebean-orm.github.io/xml/ns/dbmigration">
    <changeSet type="apply">
        <createTable name="pins" identityType="external" pkName="pk_pins">
            <column name="id" type="uuid" primaryKey="true" identity="true"/>
            <column name="author_id" type="uuid" notnull="true" references="users.id" foreignKeyName="fk_pins_author_id" foreignKeyIndex="ix_pins_author_id"/>
            <column name="source_url" type="varchar" notnull="true"/>
            <column name="media_url" type="varchar" notnull="true"/>
            <column name="description" type="varchar" notnull="true"/>
            <column name="when_created" type="timestamp" notnull="true"/>
            <column name="when_modified" type="timestamp" notnull="true"/>
        </createTable>
        <createTable name="pin_tag_model" pkName="pk_pin_tag_model">
            <column name="pin_id" type="uuid" notnull="true" references="pins.id" foreignKeyName="fk_pin_tag_model_pin_id" foreignKeyIndex="ix_pin_tag_model_pin_id"/>
            <column name="tag_id" type="uuid" notnull="true" references="tags.id" foreignKeyName="fk_pin_tag_model_tag_id" foreignKeyIndex="ix_pin_tag_model_tag_id"/>
        </createTable>
        <createTable name="tags" identityType="external" pkName="pk_tags">
            <column name="id" type="uuid" primaryKey="true" identity="true"/>
            <column name="author_id" type="uuid" notnull="true" references="users.id" foreignKeyName="fk_tags_author_id" foreignKeyIndex="ix_tags_author_id"/>
            <column name="name" type="varchar" notnull="true"/>
            <column name="when_created" type="timestamp" notnull="true"/>
            <column name="when_modified" type="timestamp" notnull="true"/>
        </createTable>
        <createTable name="user_password_hashes" identityType="external" pkName="pk_user_password_hashes">
            <column name="id" type="uuid" primaryKey="true" identity="true"/>
            <column name="user_id" type="uuid" notnull="true" references="users.id" foreignKeyName="fk_user_password_hashes_user_id" foreignKeyIndex="ix_user_password_hashes_user_id"/>
            <column name="hash" type="varchar" notnull="true"/>
            <column name="algorithm" type="integer" notnull="true" checkConstraint="check ( algorithm in (0))" checkConstraintName="ck_user_password_hashes_algorithm"/>
            <column name="when_created" type="timestamp" notnull="true"/>
            <column name="when_modified" type="timestamp" notnull="true"/>
        </createTable>
    </changeSet>
</migration>